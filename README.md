# Suprema CLUe - 클라우드 기반 통합 보안 관리 플랫폼

> 출입통제(Access Control) 및 방문자 관리(Visitor Management) 웹 포털 시스템

**관련 문서**: [구현 계획](docs/plan.md) | [용어집](docs/glossary.md) | [비즈니스 컨텍스트](docs/business-requirements.md) | [기술 명세서](docs/techspec/techspec.md)

---

## 🏢 시스템 개요

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         Suprema CLUe Platform                           │
│                   (클라우드 기반 통합 보안 관리 플랫폼)                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   ┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐   │
│   │  출입통제    │  │  방문자관리  │  │  영상보안   │  │  근태관리    │   │
│   │   (AC)      │  │  (Visitor)  │  │  (Video)    │  │  (T&A)      │   │
│   └─────────────┘  └─────────────┘  └─────────────┘  └─────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 핵심 가치 제안

- **관리 효율성 향상**: 중앙 집중식 관리로 운영 비용 절감
- **실시간 모니터링**: 출입 현황 및 장치 상태 실시간 확인
- **유연한 권한 관리**: 사용자별, 시간대별 세밀한 권한 설정
- **방문자 편의성**: QR 코드 기반 간편 체크인/체크아웃
- **데이터 분석**: 출입 패턴 분석 및 인사이트 제공

---

## 📊 조직 계층 구조 (Hierarchy)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       출입통제 계층 구조                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                    Branch (지사)                                 │   │
│  │  최상위 관리 단위 - 여러 대리점 포함                               │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │               Distributor (대리점)                               │   │
│  │  브랜치 하위 관리 단위                                            │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │              Place Group (공간그룹)                              │   │
│  │  여러 공간을 그룹화한 단위                                         │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                  Place (공간)                                    │   │
│  │  물리적 장소 (사무실, 매장 등)                                     │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                   Door (출입문)                                  │   │
│  │  출입을 제어하는 문                                               │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                 Device (장치)                                    │   │
│  │  인증 수행 하드웨어 (리더기, 컨트롤러)                              │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 👤 사용자 페르소나 및 권한 구조

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         사용자 권한 피라미드                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                    ┌──────────────────────┐                            │
│                    │  SUPREMA_MANUFACTURE │                            │
│                    │   (제조사 관리자)      │                            │
│                    │  전체 시스템 관리       │                            │
│                    └──────────────────────┘                            │
│                              │                                          │
│                              ▼                                          │
│                    ┌──────────────────────┐                            │
│                    │  SERVICE_OPERATOR    │                            │
│                    │   (서비스 운영자)      │                            │
│                    │   고객 계정 관리       │                            │
│                    └──────────────────────┘                            │
│                              │                                          │
│              ┌───────────────┼───────────────┐                         │
│              ▼               ▼               ▼                         │
│   ┌─────────────────┐ ┌─────────────┐ ┌─────────────────┐              │
│   │  BRANCH_ADMIN   │ │ DISTRIBUTOR │ │ PLACE_GROUP     │              │
│   │  (지사 관리자)   │ │  _ADMIN     │ │  _ADMIN         │              │
│   │                 │ │ (대리점)     │ │ (공간그룹)       │              │
│   └─────────────────┘ └─────────────┘ └─────────────────┘              │
│                              │                                          │
│              ┌───────────────┴───────────────┐                         │
│              ▼                               ▼                         │
│     ┌───────────────┐               ┌───────────────┐                  │
│     │     USER      │               │ VISITOR_MEMBER │                  │
│     │  (일반 사용자) │               │  (방문자 회원)  │                  │
│     │ 출입 권한 보유  │               │ 방문 예약/체크인 │                  │
│     └───────────────┘               └───────────────┘                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🚪 출입통제 핵심 플로우

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       출입 인증 프로세스                                  │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────┐       ┌─────────┐       ┌─────────┐       ┌─────────┐    │
│  │  사용자  │──────▶│  장치   │──────▶│  서버   │──────▶│  출입문  │    │
│  │         │       │ (인증)   │       │ (검증)   │       │  (개방)  │    │
│  └─────────┘       └─────────┘       └─────────┘       └─────────┘    │
│       │                 │                 │                 │          │
│       │                 │                 │                 │          │
│       ▼                 ▼                 ▼                 ▼          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      인증 수단 선택                              │   │
│  ├─────────────────────────────────────────────────────────────────┤   │
│  │  🔲 QR 코드    👤 얼굴     👆 지문     💳 카드     🔢 PIN        │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                              │                                          │
│                              ▼                                          │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      보안 수준                                   │   │
│  ├──────────────────┬──────────────────┬───────────────────────────┤   │
│  │      낮음        │       중간       │          높음              │   │
│  │  카드/QR 단독    │   얼굴/지문 단독  │   카드+얼굴 / 코드+PIN     │   │
│  └──────────────────┴──────────────────┴───────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 출입문 상태 및 제어

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         출입문 상태 다이어그램                            │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                        ┌─────────────┐                                  │
│                        │   NORMAL    │                                  │
│                        │  (정상 동작) │                                  │
│                        └──────┬──────┘                                  │
│                               │                                          │
│           ┌───────────────────┼───────────────────┐                     │
│           │                   │                   │                     │
│           ▼                   ▼                   ▼                     │
│  ┌────────────────┐  ┌────────────────┐  ┌────────────────┐            │
│  │   ONCE_OPEN    │  │  ALWAYS_OPEN   │  │  ALWAYS_CLOSE  │            │
│  │   (일시 열림)   │  │  (고정 개방)    │  │  (고정 잠금)    │            │
│  │   손님 맞이     │  │  화재 비상대피  │  │  보안 사고 시   │            │
│  └────────────────┘  └────────────────┘  └────────────────┘            │
│                               │                                          │
│                               ▼                                          │
│                  ┌─────────────────────────┐                            │
│                  │  RELEASE_MANUAL_MODE    │                            │
│                  │    (수동 모드 해제)       │                            │
│                  │     정상 모드 복귀        │                            │
│                  └─────────────────────────┘                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🧑‍💼 방문자 관리 플로우

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       방문자 관리 프로세스                                │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                         방문 예약 단계                            │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│     ① 방문 신청          ② 호스트 알림         ③ 승인/거절             │
│  ┌─────────────┐      ┌─────────────┐      ┌─────────────┐            │
│  │   방문자     │─────▶│   호스트    │─────▶│   승인 처리  │            │
│  │ 일정 신청    │      │ 알림 수신   │      │             │            │
│  └─────────────┘      └─────────────┘      └─────────────┘            │
│                                                    │                    │
│                                                    ▼                    │
│  ┌──────────────────────────────────────────────────────────────────┐  │
│  │                         방문 당일                                 │  │
│  └──────────────────────────────────────────────────────────────────┘  │
│                                                                         │
│     ④ QR 발급            ⑤ 체크인             ⑥ 체크아웃              │
│  ┌─────────────┐      ┌─────────────┐      ┌─────────────┐            │
│  │  동적 QR    │─────▶│  QR 인증    │─────▶│  방문 완료   │            │
│  │  코드 발송   │      │  출입       │      │  기록       │            │
│  └─────────────┘      └─────────────┘      └─────────────┘            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

### 방문자 상태 전이

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       방문자 상태 전이                                   │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│   BEFORE_VISIT ────▶ CHECK_IN ────▶ CHECK_OUT                          │
│    (방문 예정)         (방문 중)       (방문 완료)                        │
│         │                                                               │
│         └─────────────────▶ CANCELLED (취소)                            │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 📱 장치 연동 아키텍처

```
┌─────────────────────────────────────────────────────────────────────────┐
│                        장치 연동 구조                                    │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│                    ┌───────────────────────┐                            │
│                    │      CLUe Cloud       │                            │
│                    │   (클라우드 서버)       │                            │
│                    └───────────┬───────────┘                            │
│                                │                                         │
│                    ┌───────────┴───────────┐                            │
│                    │      Network          │                            │
│                    │   (인터넷 연결)         │                            │
│                    └───────────┬───────────┘                            │
│                                │                                         │
│       ┌────────────────────────┼────────────────────────┐               │
│       │                        │                        │               │
│       ▼                        ▼                        ▼               │
│  ┌─────────────┐         ┌─────────────┐         ┌─────────────┐       │
│  │ BioStation3 │         │ XStation2   │         │ SecureIO    │       │
│  │  (생체인증)  │         │ (복합인증)   │         │  (I/O 모듈)  │       │
│  └─────────────┘         └──────┬──────┘         └─────────────┘       │
│                                 │                                        │
│                      ┌──────────┴──────────┐                            │
│                      │      RS485          │                            │
│                      │    (슬레이브)        │                            │
│                      └──────────┬──────────┘                            │
│                                 │                                        │
│                ┌────────────────┼────────────────┐                      │
│                ▼                ▼                ▼                      │
│           ┌─────────┐     ┌─────────┐     ┌─────────┐                   │
│           │ XPass2  │     │BioLiteN2│     │BioEntryW3│                  │
│           │(카드리더)│     │ (지문)   │     │ (방수)   │                  │
│           └─────────┘     └─────────┘     └─────────┘                   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🏗️ 기술 아키텍처 (MVVM)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                       Flutter MVVM 아키텍처                              │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                         View Layer                               │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                    Page (UI Widget)                       │   │   │
│  │  │            UI 렌더링 & 사용자 인터랙션                      │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                  ↕                                      │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                      ViewModel Layer                             │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │              PageViewModel (Riverpod Notifier)            │   │   │
│  │  │             비즈니스 로직 & 상태 관리                       │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                  ↕                                      │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                       Data Layer                                 │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                    Repository                             │   │   │
│  │  │              데이터 소스 추상화 & 흐름 제어                  │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  │                                  ↕                               │   │
│  │  ┌──────────────────────────────────────────────────────────┐   │   │
│  │  │                 RestClient (Retrofit + Dio)               │   │   │
│  │  │                    API 통신 & 원격 데이터                   │   │   │
│  │  └──────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                  ↕                                      │
│  ┌─────────────────────────────────────────────────────────────────┐   │
│  │                     Backend Servers                              │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐              │   │
│  │  │ Auth Server │  │Device Server│  │Place Server │              │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘              │   │
│  └─────────────────────────────────────────────────────────────────┘   │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 📋 핵심 비즈니스 규칙 요약

```
┌─────────────────────────────────────────────────────────────────────────┐
│                         핵심 비즈니스 규칙                               │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  🔐 보안 규칙                                                           │
│  ├── 생체정보 수집 전 명시적 동의 필수 (개인정보보호법)                    │
│  ├── 모든 인증 시도 및 출입 이벤트 로그 기록                              │
│  └── 감사 로그 3년 보관                                                  │
│                                                                         │
│  🚪 출입 규칙                                                           │
│  ├── 명시적 출입 권한 부여 시에만 출입 가능                               │
│  ├── 출입 기간: 무제한 / 기간지정 / 일회성                                │
│  └── 출입 스케줄: ALWAYS / SPECIFIC (시간대별)                           │
│                                                                         │
│  👤 방문자 규칙                                                          │
│  ├── 방문 일정은 호스트/관리자 승인 필요                                  │
│  ├── 동적 QR 코드로 출입 (방문 시간만 유효)                               │
│  └── 체크아웃 시 QR 즉시 무효화                                          │
│                                                                         │
│  📱 장치 규칙                                                            │
│  ├── 설정 변경 시 자동 장치 동기화                                        │
│  ├── 동기화 실패 시 최대 3회 재시도                                       │
│  └── 장치 상태 주기적 모니터링 (네트워크, 펌웨어, 디스크)                  │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🗺️ 구현 로드맵 (Phase별)

```
┌─────────────────────────────────────────────────────────────────────────┐
│                          구현 로드맵                                     │
├─────────────────────────────────────────────────────────────────────────┤
│                                                                         │
│  Phase 0 ✅     Phase 1       Phase 2       Phase 3       Phase 4+      │
│  ──────────    ──────────    ──────────    ──────────    ──────────     │
│  초기 설정     핵심 인프라    출입통제      방문자관리     고급 기능       │
│                                                                         │
│  ├─ SDK 설치   ├─ 인증 시스템  ├─ 장치 관리   ├─ 방문 예약   ├─ 조직 관리   │
│  ├─ 의존성     ├─ 라우팅      ├─ 출입문 관리 ├─ 체크인/아웃 ├─ 권한 관리   │
│  ├─ 폴더 구조  ├─ 공통 컴포넌트├─ 인증 관리   ├─ QR 코드     ├─ 스케줄     │
│  └─ 린트 규칙  └─ 에러 핸들링 ├─ 출입 권한   └─ 방문 상태   ├─ 플러그인    │
│                              └─ 이벤트/로그               ├─ 대시보드    │
│                                                          └─ AI 분석     │
│                                                                         │
│     완료         진행중         대기          대기          대기          │
│     ████         ░░░░         ░░░░          ░░░░          ░░░░          │
│                                                                         │
└─────────────────────────────────────────────────────────────────────────┘
```

---

## 🛠️ 기술 스택

| 분류 | 기술 |
|------|------|
| **프레임워크** | Flutter SDK 3.6.1+ (Web) |
| **상태 관리** | Riverpod |
| **라우팅** | go_router |
| **네트워킹** | Dio, Retrofit |
| **직렬화** | json_serializable |
| **코드 생성** | build_runner |
| **값 비교** | Equatable |

---

## 🚀 빠른 시작

### 1. 의존성 설치

```bash
flutter pub get
```

### 2. 코드 생성

```bash
dart run build_runner build --delete-conflicting-outputs
```

### 3. 웹 실행

```bash
flutter run -d chrome
```

---

## 📁 폴더 구조

```
lib/
├── main.dart                 # 앱 진입점
├── app/
│   ├── router/              # go_router 설정
│   └── theme/               # 테마 설정
├── core/
│   ├── constants/           # 상수 정의
│   ├── utils/               # 유틸리티 함수
│   └── extensions/          # 확장 메서드
├── data/
│   ├── models/              # 데이터 모델 (json_serializable)
│   ├── repositories/        # Repository 구현
│   └── rest_api.dart        # RestClient (retrofit)
├── views/
│   ├── pages/               # 페이지별 폴더
│   │   └── [feature]/       # 기능별 폴더
│   │       ├── [feature]_page.dart      # UI 페이지
│   │       ├── [feature]_page_vm.dart   # ViewModel (riverpod)
│   │       └── widgets/                 # 기능별 위젯
│   └── widgets/             # 공통 재사용 위젯
```

---

## 📚 관련 문서

- [구현 계획](docs/plan.md) - 전체 구현 계획 및 체크리스트
- [비즈니스 컨텍스트](docs/business-requirements.md) - 서비스/도메인별 비즈니스 요구사항
- [기술 명세서](docs/techspec/techspec.md) - 주요 기술 사양 및 상세 스펙
- [개발 용어집](docs/glossary.md) - 프로젝트 개발 용어 및 개념 정리

---

> 이 프로젝트는 Suprema CLUe 클라우드 기반 통합 보안 관리 플랫폼입니다.

